function rho = density_model(h)

%input  h: altitude in [km]
% h = h/10^3;
% if h < 0
%     h0 = 0;
%     rho0 = 1.225;
%     H = 7.249;
% 
% elseif h >= 0 && h < 25
%     h0 = 0;
%     rho0 = 1.225;
%     H = 7.249;
% 
% elseif h >= 25 && h < 30
%     h0 = 25;
%     rho0 = 3.899e-2;
%     H = 6.349;
% 
% elseif h >= 30 && h < 40
%     h0 = 30;
%     rho0 = 1.774e-2;
%     H = 6.682;
% 
% elseif h >= 40 && h < 50
%     h0 = 40;
%     rho0 = 3.972e-3;
%     H = 7.554;
% 
% elseif h >= 50 && h < 60
%     h0 = 50;
%     rho0 = 1.057e-3;
%     H = 8.4;
% 
% elseif h >= 60 && h < 70
%     h0 = 60;
%     rho0 = 3.206e-4;
%     H = 7.714;
% 
% elseif h >= 70 && h < 80
%     h0 = 70;
%     rho0 = 8.770e-5;
%     H = 6.549;
% elseif h >= 80 && h < 90
%     h0 = 80;
%     rho0 = 1.905e-5;
%     H = 5.799;
% elseif h >= 90 
%     h0 = 90;
%     rho0 = 3.396e-6;
%     H = 5.382;
% end

h0_vect = [0 25 30 40 50 60 70 80 90 100 110 120 130 140 150 ...
        180 200 250 300 350 400 450 500 600 700 800 900 1000]';
    rho0_vect = [1.225 3.899*1e-2 1.774*1e-2 3.972*1e-3 1.057*1e-3 ...
        3.206*1e-4 8.770*1e-5 1.905*1e-5 3.396*1e-6 5.297*1e-7 9.661*1e-8 ...
        2.438*1e-8 8.484*1e-9 3.845*1e-9 2.070*1e-9 5.464*1e-10 ...
        2.789*1e-10 7.248*1e-11 2.418*1e-11 9.158*1e-12 3.725*1e-12 ...
        1.585*1e-12 6.967*1e-13 1.454*1e-13 3.614*1e-14 1.170*1e-14 ...
        5.245*1e-15 3.019*1e-15]';
    H_vect = [7.249 6.349 6.682 7.554 8.382 7.714 6.549 5.799 5.382 5.877 ...
        7.263 9.473 12.636 16.149 22.523 29.740 37.105 45.546 53.628 ...
        53.298 58.515 60.828 63.822 71.835 88.667 124.64 181.05 268.00]';

if h < 0
    rho0 =0;
    h0 = 0;                            % [km]
    H = 0;                              % [km]
else
    idx = sum(h0_vect < h);

    rho0 = rho0_vect(idx);
    h0 = h0_vect(idx);                            % [km]
    H = H_vect(idx);                              % [km]
end
    rho = rho0 * exp(-(h-h0)/H);                % [kg/m^3]



end